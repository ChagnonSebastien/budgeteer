syntax = "proto3";

package transaction;

option go_package = "server/internal/infrastructure/messaging/dto";

enum SplitType {
  Equal = 0;
  Percentage = 1;
  Share = 2;
}

message TransactionGroupMember {
  string email = 1;
  string name = 2;
  optional float splitValue = 3;
}

message TransactionGroup {
  uint32 id = 1;
  string name = 2;
  string initial_currency = 3;
  SplitType splitType = 4;
  repeated TransactionGroupMember members = 5;
  optional uint32 currency = 6;
  optional uint32 category = 7;

}

message GetAllTransactionGroupsRequest {
}

message GetAllTransactionGroupsResponse {
  repeated TransactionGroup transactionGroups = 1;
}

message CreateTransactionGroupRequest {
  string name = 1;
  string initial_currency = 2;
  SplitType splitType = 3;
  uint32 currency = 4;
  uint32 category = 5;
}

message CreateTransactionGroupResponse {
  uint32 id = 1;
}

message UpdateTransactionGroupFields {
  optional string name = 1;
  optional SplitType splitType = 2;
  optional uint32 currency = 3;
  optional uint32 category = 4;
}

message UpdateTransactionGroupRequest {
  uint32 id = 1;
  UpdateTransactionGroupFields fields = 2;
}

message UpdateTransactionGroupResponse {
}

message TransactionGroupMemberRequest {
  uint32 transaction_group_id = 1;
  string email = 2;
}

message TransactionGroupMemberResponse {
}

message UpdateTransactionGroupMembersRequest {
  uint32 transaction_group_id = 1;
  repeated TransactionGroupMember members = 2;
}

message UpdateTransactionGroupMembersResponse {
}

service TransactionGroupService {
  rpc GetAllTransactionGroups (GetAllTransactionGroupsRequest) returns (GetAllTransactionGroupsResponse);
  rpc CreateTransactionGroup (CreateTransactionGroupRequest) returns (CreateTransactionGroupResponse);
  rpc UpdateTransactionGroup (UpdateTransactionGroupRequest) returns (UpdateTransactionGroupResponse);
  rpc AddTransactionGroupMember (TransactionGroupMemberRequest) returns (TransactionGroupMemberResponse);
  rpc RemoveTransactionGroupMember (TransactionGroupMemberRequest) returns (TransactionGroupMemberResponse);
  rpc UpdateTransactionGroupMembers (UpdateTransactionGroupMembersRequest) returns (UpdateTransactionGroupMembersResponse);
}